<div id="inserted">
    <div class="leftPanel settingsLeft">
        <ul class="panelList">
            <li id="gestures" onclick="loadMain()" tabindex="0"><img class="wifi" draggable="false"
                                                                                    src="images/wave.svg">
                <h2>Gestures</h2></li>
            <li id="connection " tabindex="0" onclick="loadContent('pages/connection.html')"><img class="wifi" draggable="false" src="images/wifi.svg">
                <h2>Connection</h2></li>
            <li class="selected" id="settings" tabindex="0"><img class="wifi" draggable="false"
                                                                 src="images/settings.svg">
                <h2>Settings</h2></li>
            <li tabindex="0" id = "help" onclick="loadContent('pages/help.html')" ><img class = "wifi" src="images/help.svg" draggable="false"><h2>Help</h2></li>

        </ul>
    </div>

    <div class="centrePanel settingsCentre" id="centre">
        <h1 class="bigTitle" id="title">Settings</h1>


        <div class="tabcontent" id="General">
            <ul class="settingsList" id="generalList">
                <h2>General</h2>
                <li class="settingsCheckbox" tabindex="0">
                    <h3>Allow Webcam access</h3>
                    <label class="tickbox" id="webcamTickbox">
                        <input type="checkbox">
                        <span class="checkmark"></span>
                    </label>
                </li>
                <li class="settingsCheckbox" tabindex="0">
                    <h3>Show skeleton</h3>
                    <label class="tickbox" id="skeletonTickbox">
                        <input type="checkbox">
                        <span class="checkmark"></span>
                    </label>
                </li>

                <li class="settingsDropdown" tabindex="0">
                    <h3>Theme</h3>
                    <div class="custom-select" id="themeSelect">
                        <select>
                            <option value="0">Select a Theme:</option>
                            <option value="1">Light Blue</option>
                            <option value="2">Dark Blue</option>
                        </select>
                    </div>
                </li>

                <h2 style="margin-top: 50px">Performance</h2>

                <li class="settingsSlider" tabindex="0">
                    <h3>Performance Presets</h3>
                    <div class="slidecontainer">
                        <input , class="slider" id="myRange" max="100" min="0" step="25" type="range" value="50">
                    </div>
                </li>

                <li class="settingsDropdown" tabindex="0">
                    <h3>Architecture</h3>
                    <div class="custom-select" id="architectureSelect">
                        <select>
                            <option value="0">Architecture:</option>
                            <option value="1">MobileNetV1</option>
                            <option value="2">ResNet50</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Output stride</h3>
                    <div class="custom-select" id="outputSelect">
                        <select>
                            <option value="0">Output stride:</option>
                            <option value="1">8</option>
                            <option value="2">16</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Multiplier</h3>
                    <div class="custom-select" id="multiplierSelect">
                        <select>
                            <option value="0">Multiplier:</option>
                            <option value="1">1.01</option>
                            <option value="2">1.0</option>
                            <option value="3">0.75</option>
                            <option value="4">0.5</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Quant bytes</h3>
                    <div class="custom-select" id="quantSelect">
                        <select>
                            <option value="0">Quant Bytes:</option>
                            <option value="1">2</option>
                            <option value="2">4</option>
                        </select>
                    </div>
                </li>


            </ul>
        </div>

        <div class="tabcontent" id="Controls">
            <ul class="settingsList" id="controlsList">
                <h2>Controls</h2>


                <li class="settingsDropdown" tabindex="0">
                    <h3>Play / Pause</h3>
                    <div class="custom-select" id="playSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>

                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Rewind</h3>
                    <div class="custom-select" id="rewindSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Fast Forward</h3>
                    <div class="custom-select" id="forwardSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Previous</h3>
                    <div class="custom-select" id="previousSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Next</h3>
                    <div class="custom-select" id="nextSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Volume Down</h3>
                    <div class="custom-select" id="volDownSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Volume Up</h3>
                    <div class="custom-select" id="volUpSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>
                        </select>
                    </div>
                </li>
                <li class="settingsDropdown" tabindex="0">
                    <h3>Mute</h3>
                    <div class="custom-select" id="muteSelect">
                        <select>
                            <option value="0">Pose:</option>
                            <option value="1">Left arm up</option>
                            <option value="2">Right arm up</option>
                            <option value="3">Left arm out</option>
                            <option value="4">Right arm out</option>
                            <option value="5">Left arm 90deg up</option>
                            <option value="6">Right arm 90deg up</option>
                            <option value="7">T Pose</option>
                            <option value="9">Ears Covered</option>
                            <option value="8">Unset</option>
                        </select>
                    </div>
                </li>

            </ul>
        </div>

    </div>

    <div class="rightPanel">
        <ul class="panelList">
            <li class="selected tablinks" id="generalTab" onclick="changeTab(event, 'General')" tabindex="0"><img
                    class="wifi"
                    draggable="false"
                    src="images/wave.svg">
                <h2>General</h2></li>
            <li id="controlsTab tablinks" onclick="setupControlTab()" tabindex="0"><img class="wifi" draggable="false"
                                                                                        src="images/settings.svg">
                <h2>Controls</h2></li>

            <li class="save" id="connectionStatus" tabindex="0"><img class="wifi"
                                                                     draggable="false"
                                                                     src="images/save.svg">
                <h2>Save</h2></li>

        </ul>
    </div>
    <script>

        $().ready(() => {
            $(".leftPanel li").on("click", function () {
                $(".leftPanel .selected").toggleClass("selected");
                $(this).toggleClass("selected");
            });
            $(".rightPanel li").on("click", function () {
                $(".rightPanel .selected").toggleClass("selected");
                $(this).toggleClass("selected");
            });
            $("#connectionStatus").on("click", () => {
                let tab = $(".rightPanel li.active h2")[0].innerHTML;
                if (tab === "Controls") {
                    saveControlSettings();
                } else {
                    saveSettings();
                }
            });

            // $("#kodiList li")


            document.getElementById("generalTab").click();
            setupDropdowns();
            setupDropdown("#themeSelect", settings.readSetting("theme"));

            setupDropdown("#architectureSelect", settings.readPerformanceSetting("architecture"));
            setupDropdown("#outputSelect", settings.readPerformanceSetting("stride"));
            setupDropdown("#multiplierSelect", settings.readPerformanceSetting("multiplier"));
            setupDropdown("#quantSelect", settings.readPerformanceSetting("quant"));

            if (settings.readSetting("webcamEnabled")) {
                $("#webcamTickbox input").click()
            }
            if (settings.readSetting("showSkeleton")) {
                $("#skeletonTickbox input").click()
            }



            $("#myRange").on("change", () => {
                let value = int($("#myRange")[0].value);
                // console.log(value)
                if (value === 0) {
                    setupDropdown("#architectureSelect", "MobileNetV1");
                    setupDropdown("#outputSelect", "16");
                    setupDropdown("#multiplierSelect", "0.5");
                    setupDropdown("#quantSelect", "2");
                }
                if (value === 25) {
                    setupDropdown("#architectureSelect", "MobileNetV1");
                    setupDropdown("#outputSelect", "16");
                    setupDropdown("#multiplierSelect", "0.75");
                    setupDropdown("#quantSelect", "2");
                }
                if (value === 50) {
                    setupDropdown("#architectureSelect", "MobileNetV1");
                    setupDropdown("#outputSelect", "8");
                    setupDropdown("#multiplierSelect", "1");
                    setupDropdown("#quantSelect", "2");
                }
                if (value === 75) {
                    setupDropdown("#architectureSelect", "ResNet50");
                    setupDropdown("#outputSelect", "16");
                    setupDropdown("#multiplierSelect", "1");
                    setupDropdown("#quantSelect", "2");
                }
                if (value === 100) {
                    setupDropdown("#architectureSelect", "ResNet50");
                    setupDropdown("#outputSelect", "16");
                    setupDropdown("#multiplierSelect", "1.01");
                    setupDropdown("#quantSelect", "4");
                }

            });
        });

        function getNotUnique(array) {
            var map = new Map();
            array.forEach(a => {
                if (a.innerHTML !== "Unset") {
                    map.set(a.innerHTML, (map.get(a.innerHTML) || 0) + 1)
                }
            });
            return array.filter(a => map.get(a.innerHTML) > 1);
        }

        function dropdownChanged() {
            let tab = $(".rightPanel li.active h2")[0].innerHTML;
            if (tab === "Controls") {
                let items = Array.from($("#controlsList li .select-selected").toArray(), x => x.innerHTML);
                const uniqueArray = Array.from(new Set(items));
                if (items.length === uniqueArray.length) {
                    console.log("all unique!");
                    $("#controlsList li div").removeClass("invalid");

                } else {
                    console.log("uh oh");
                    let duplicates = getNotUnique($("#controlsList li .select-selected").toArray());
                    $("#controlsList li div").removeClass("invalid");
                    console.log(duplicates.length);
                    duplicates.forEach((item) => {
                        $(item.parentElement).addClass("invalid");
                    })
                }
            }


        }

        // Get the element with id="defaultOpen" and click on it
        document.getElementById("defaultTab").click();


        function updateDropdown() {
            /* When an item is clicked, update the original select box,
            and the selected item: */
            var y, i, k, s, h;
            s = this.parentNode.parentNode.getElementsByTagName("select")[0];
            h = this.parentNode.previousSibling;
            for (i = 0; i < s.length; i++) {
                if (s.options[i].innerHTML === this.innerHTML) {
                    s.selectedIndex = i;
                    h.innerHTML = this.innerHTML;
                    y = this.parentNode.getElementsByClassName("same-as-selected");
                    for (k = 0; k < y.length; k++) {
                        y[k].removeAttribute("class");
                    }
                    this.setAttribute("class", "same-as-selected");
                    break;
                }
            }
            // console.log(h);
            h.click();
            dropdownChanged();

        }

        function setupDropdowns() {
            var x, i, j, selElmnt, a, b, c;
            /* Look for any elements with the class "custom-select": */
            x = document.getElementsByClassName("custom-select");
            for (i = 0; i < x.length; i++) {
                selElmnt = x[i].getElementsByTagName("select")[0];
                /* For each element, create a new DIV that will act as the selected item: */
                a = document.createElement("DIV");
                a.setAttribute("class", "select-selected");
                a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
                x[i].appendChild(a);
                /* For each element, create a new DIV that will contain the option list: */
                b = document.createElement("DIV");
                b.setAttribute("class", "select-items select-hide");
                for (j = 1; j < selElmnt.length; j++) {
                    /* For each option in the original select element,
                    create a new DIV that will act as an option item: */
                    c = document.createElement("DIV");
                    c.innerHTML = selElmnt.options[j].innerHTML;
                    c.addEventListener("click", updateDropdown);
                    b.appendChild(c);
                }
                x[i].appendChild(b);
                a.addEventListener("click", function (e) {
                    /* When the select box is clicked, close any other select boxes,
                    and open/close the current select box: */
                    e.stopPropagation();
                    closeAllSelect(this);
                    this.nextSibling.classList.toggle("select-hide");
                    this.classList.toggle("select-arrow-active");


                    // alert("clicked");
                });
            }
        }


        function closeAllSelect(elmnt) {
            /* A function that will close all select boxes in the document,
            except the current select box: */
            var x, y, i, arrNo = [];
            x = document.getElementsByClassName("select-items");
            y = document.getElementsByClassName("select-selected");
            for (i = 0; i < y.length; i++) {
                if (elmnt === y[i]) {
                    arrNo.push(i)
                } else {
                    y[i].classList.remove("select-arrow-active");
                }
            }
            for (i = 0; i < x.length; i++) {
                if (arrNo.indexOf(i)) {
                    x[i].classList.add("select-hide");
                }
            }
        }


        /* If the user clicks anywhere outside the select box,
        then close all select boxes: */
        document.addEventListener("click", closeAllSelect);

    </script>
</div>
